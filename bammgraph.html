<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. BAMM graph gallery &#8212; bamm 2.5.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bamm.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Rate Shifts on Phylogenies: Theoretical Background" href="rateshifts.html" />
    <link rel="prev" title="2. Announcements" href="announcements.html" /> 
  </head>
  <body role="document">
<div class="pageheader">
    <img src="_static/bamm-header.png" /img>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="rateshifts.html" title="4. Rate Shifts on Phylogenies: Theoretical Background"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="announcements.html" title="2. Announcements"
             accesskey="P">previous</a> |</li>
<li><a href="index.html">Home</a>&nbsp;|</li>
<li><a href="download.html">Download</a>&nbsp;|</li>
<li><a href="documentation.html">Documentation</a>&nbsp;|</li>
<li><a href="contact_us.html">Contact Us</a></li>
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="documentation.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. BAMM graph gallery</a><ul>
<li><a class="reference internal" href="#phylorate-plot">3.1. Phylorate plot</a></li>
<li><a class="reference internal" href="#individual-rate-shift-configurations-sampled-by-bamm">3.2. Individual rate-shift configurations sampled by BAMM</a></li>
<li><a class="reference internal" href="#distinct-shift-configurations-and-their-frequencies">3.3. Distinct shift configurations and their frequencies</a></li>
<li><a class="reference internal" href="#macroevolutionary-cohort-matrix">3.4. Macroevolutionary cohort matrix</a></li>
<li><a class="reference internal" href="#phenotypic-evolutionary-rates">3.5. Phenotypic evolutionary rates</a></li>
<li><a class="reference internal" href="#rate-variation-through-time-color-density-plot">3.6. Rate variation through time: color density plot</a></li>
<li><a class="reference internal" href="#evolutionary-rate-variation-through-time-grayscale">3.7. Evolutionary rate variation through time: grayscale</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="announcements.html"
                        title="previous chapter">2. Announcements</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="rateshifts.html"
                        title="next chapter">4. Rate Shifts on Phylogenies: Theoretical Background</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/bammgraph.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="bamm-graph-gallery">
<span id="bammgraphs"></span><h1>3. BAMM graph gallery<a class="headerlink" href="#bamm-graph-gallery" title="Permalink to this headline">¶</a></h1>
<p>A collection of graphics from BAMM and BAMMtools. R code to produce images is given below each panel. Much more detail on BAMMtools analysis is given <a class="reference internal" href="postprocess.html#bammtools"><span class="std std-ref">here</span></a>.</p>
<div class="section" id="phylorate-plot">
<h2>3.1. Phylorate plot<a class="headerlink" href="#phylorate-plot" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="whales-polar">
<a class="reference internal image-reference" href="_images/whales_polar.png"><img alt="_images/whales_polar.png" src="_images/whales_polar.png" style="width: 400px;" /></a>
</div>
<p>A <strong>phylorate plot</strong> showing speciation rates (cool colors = slow, warm = fast) along each branch of the whale phylogeny from Steeman <em>et al.</em> (2009). Each unique color section of a branch represents the mean of the marginal posterior density of speciation rates on a localized segment of a phylogenetic tree. The &#8220;background rate&#8221; for lineages involves a temporal deceleration in speciation rates (note warm colors at root). One clade - the dolphins - is characterized by a massive increase in the rate of speciation:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">library</span><span class="p">(</span><span class="n">BAMMtools</span><span class="p">)</span>
<span class="n">data</span><span class="p">(</span><span class="n">whales</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">whales</span><span class="p">)</span>
<span class="n">edata_whales</span> <span class="o">&lt;-</span> <span class="n">getEventData</span><span class="p">(</span><span class="n">whales</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">whales</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">bammdata</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;polar&quot;</span><span class="p">,</span> <span class="n">pal</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="breaksforgallery">
<a class="reference internal image-reference" href="_images/breaksForGallery.png"><img alt="_images/breaksForGallery.png" src="_images/breaksForGallery.png" style="width: 700px;" /></a>
</div>
<p>Multiple options are available in BAMMtools for mapping colors to rates in phylorate plots. Changing these options can be particularly useful if the distribution of rates across th phylogeny is heavily skewed. See <a class="reference external" href="colorbreaks.html">Color ramps and phylorate plots</a> for more information:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">(</span><span class="n">primates</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">primates</span><span class="p">)</span>
<span class="n">ed</span> <span class="o">&lt;-</span> <span class="n">getEventData</span><span class="p">(</span><span class="n">primates</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">primates</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;trait&#39;</span><span class="p">)</span>

<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">mar</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="n">xpd</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span>

<span class="n">q</span> <span class="o">&lt;-</span> <span class="n">plot</span><span class="o">.</span><span class="n">bammdata</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">breaksmethod</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">addBAMMshifts</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">reset</span><span class="o">=</span><span class="n">FALSE</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="n">sub</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="n">cex</span><span class="o">.</span><span class="n">sub</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">addBAMMlegend</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">220</span><span class="p">))</span>

<span class="n">q</span> <span class="o">&lt;-</span> <span class="n">plot</span><span class="o">.</span><span class="n">bammdata</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">breaksmethod</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">.</span><span class="n">interval</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="n">NA</span><span class="p">,</span><span class="mf">0.12</span><span class="p">),</span> <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">addBAMMshifts</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">reset</span><span class="o">=</span><span class="n">FALSE</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="n">sub</span><span class="o">=</span><span class="s1">&#39;linear - color.interval&#39;</span><span class="p">,</span><span class="n">cex</span><span class="o">.</span><span class="n">sub</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">addBAMMlegend</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">220</span><span class="p">))</span>

<span class="n">q</span> <span class="o">&lt;-</span> <span class="n">plot</span><span class="o">.</span><span class="n">bammdata</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">tau</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">breaksmethod</span><span class="o">=</span><span class="s1">&#39;jenks&#39;</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">addBAMMshifts</span><span class="p">(</span><span class="n">ed</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">reset</span><span class="o">=</span><span class="n">FALSE</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">title</span><span class="p">(</span><span class="n">sub</span><span class="o">=</span><span class="s1">&#39;jenks&#39;</span><span class="p">,</span><span class="n">cex</span><span class="o">.</span><span class="n">sub</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">line</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">addBAMMlegend</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">220</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="individual-rate-shift-configurations-sampled-by-bamm">
<h2>3.2. Individual rate-shift configurations sampled by BAMM<a class="headerlink" href="#individual-rate-shift-configurations-sampled-by-bamm" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="whales-seprateshiftconfigs">
<a class="reference internal image-reference" href="_images/whales_sepRateShiftConfigs.png"><img alt="_images/whales_sepRateShiftConfigs.png" src="_images/whales_sepRateShiftConfigs.png" style="width: 500px;" /></a>
</div>
<p>Phylorate plots for three evolutionary rate configurations (speciation) sampled by BAMM for the cetacean phylogeny, under two different color schemes (warm colors = fast rates). Columns show the 10<sup>th</sup>, 20<sup>th</sup>, and 30<sup>th</sup> samples from the posterior distribution included as an example in BAMMtools (see the <strong>events.whales</strong> dataset). Black circles denote the position of the macroevolutionary regime shifts present in each sample. Every sample from the posterior contains a potentially unique configuration of shift locations, which are sampled in proportion to their posterior probability. The trees shown in this figure differ from the preceding figure, which shows the mean marginal rates over all samples in the posterior. Note the consistent spike and subsequent deceleration in rates that occurs after shift events:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ixx</span> <span class="o">&lt;-</span> <span class="n">rep</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">),</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">plot</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">));</span>
<span class="n">colschemes</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">();</span>
<span class="n">colschemes</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="s1">&#39;temperature&#39;</span>
<span class="n">colschemes</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="nb">list</span><span class="p">(</span><span class="n">c</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">))</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="ow">in</span> <span class="mi">1</span><span class="p">:</span><span class="n">length</span><span class="p">(</span><span class="n">ixx</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">par</span><span class="p">(</span><span class="n">mar</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">index</span> <span class="o">&lt;-</span> <span class="n">ixx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">eventsub</span> <span class="o">&lt;-</span> <span class="n">subsetEventData</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">);</span>
        <span class="n">plot</span><span class="o">.</span><span class="n">bammdata</span><span class="p">(</span><span class="n">eventsub</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="n">pal</span><span class="o">=</span> <span class="n">colschemes</span><span class="p">[[</span><span class="n">i</span><span class="p">]],</span> <span class="n">par</span><span class="o">.</span><span class="n">reset</span><span class="o">=</span><span class="n">FALSE</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">addBAMMshifts</span><span class="p">(</span><span class="n">eventsub</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">bg</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">reset</span><span class="o">=</span><span class="n">FALSE</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="distinct-shift-configurations-and-their-frequencies">
<h2>3.3. Distinct shift configurations and their frequencies<a class="headerlink" href="#distinct-shift-configurations-and-their-frequencies" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="whales-distinctshiftconfigs">
<a class="reference internal image-reference" href="_images/whales_distinctShiftConfigs.png"><img alt="_images/whales_distinctShiftConfigs.png" src="_images/whales_distinctShiftConfigs.png" style="width: 500px;" /></a>
</div>
<p>BAMM enables the user to tabulate the &#8220;distinct shift configurations&#8221; within a given dataset as well as the posterior probability of each configuration. Each distinct shift configuration may have been sampled multiple times during simulation of the posterior. This is directly analogous to a credible set of topologies from a Bayesian phylogenetic analysis. This example shows 95% credible set of shift configurations from the analysis of the whale phylogeny:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cset</span> <span class="o">&lt;-</span> <span class="n">credibleShiftSet</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">expectedNumberOfShifts</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">credibleshiftset</span><span class="p">(</span><span class="n">cset</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="macroevolutionary-cohort-matrix">
<h2>3.4. Macroevolutionary cohort matrix<a class="headerlink" href="#macroevolutionary-cohort-matrix" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="whales-cohort">
<a class="reference internal image-reference" href="_images/whales_cohort.png"><img alt="_images/whales_cohort.png" src="_images/whales_cohort.png" style="width: 700px;" /></a>
</div>
<p><a class="reference internal" href="rateshifts.html#cohortexplanation"><span class="std std-ref">Macroevolutionary cohort analysis</span></a> displays the pairwise probability that any two species share a common macroevolutionary rate dynamic. These pairwise probabilities can be extracted quickly from BAMM output using the function <code class="docutils literal"><span class="pre">getCohortMatrix</span></code>. The example above shows the cohort matrix for the whales dataset included with BAMMtools. Each cell of the cohort matrix corresponds to a pair of tip taxa from the whale phylogeny; the phylogeny is plotted for reference in the left and upper margins of the figure. You can read this plot by drawing an imaginary line between any two tips of the tree; the color of the matrix at their intersection is the probability that those taxa share a common rate dynamic. Species pairs that share a common rate dynamic have red cohort matrix colors; species with decoupled macroevolutionary dynamics have blue cohort matrix colors (the legend on the right gives the actual cohort probability). The cohort matrix method is fully explained in this (<a class="reference external" href="http://sysbio.oxfordjournals.org/content/63/4/610">Systematic Biology article</a>). The biological interpretation of the above results is that there are two general macroevolutionary dynamics across whales: one pertaining to the dolphins, and one pertaining to the non-dolphins. The small clade in the middle of the plot that shows intermediate correlations with the &#8220;fast clade&#8221; (dolphins) and &#8220;slow lineages&#8221; (non-dolphins) contains the porpoises, narwhals and belugas. BAMMtools provides functions that allow easy generation of cohort matrices:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cmat</span> <span class="o">&lt;-</span> <span class="n">getCohortMatrix</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">)</span>
<span class="n">cohorts</span><span class="p">(</span><span class="n">cmat</span><span class="p">,</span> <span class="n">edata_whales</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">pal</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="n">use</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bammdata</span><span class="o">=</span><span class="n">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="phenotypic-evolutionary-rates">
<h2>3.5. Phenotypic evolutionary rates<a class="headerlink" href="#phenotypic-evolutionary-rates" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="primates-credshiftset">
<a class="reference internal image-reference" href="_images/primates_credShiftSet.png"><img alt="_images/primates_credShiftSet.png" src="_images/primates_credShiftSet.png" style="width: 700px;" /></a>
</div>
<p>BAMM and BAMMtools can also be used to analyze rates of phenotypic evolution. Here are the four most probable macroevolutionary rate shift configurations (and their overall frequencies) for the evolution of body size across a phylogenetic tree of living primates. As in the above phylorate plots, branch colors reflect the instantaneous rate of body size evolution. This dataset is included as an example with BAMMtools:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">(</span><span class="n">primates</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">primates</span><span class="p">)</span>
<span class="n">ed_prim</span> <span class="o">&lt;-</span> <span class="n">getEventData</span><span class="p">(</span><span class="n">primates</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">primates</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="s2">&quot;trait&quot;</span><span class="p">)</span>
<span class="n">css_prim</span> <span class="o">&lt;-</span> <span class="n">credibleShiftSet</span><span class="p">(</span><span class="n">ed_prim</span><span class="p">,</span> <span class="n">expectedNumberOfShifts</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plot</span><span class="o">.</span><span class="n">credibleshiftset</span><span class="p">(</span><span class="n">css_prim</span><span class="p">,</span> <span class="n">lwd</span><span class="o">=</span><span class="mf">1.7</span><span class="p">,</span> <span class="n">plotmax</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="rate-variation-through-time-color-density-plot">
<h2>3.6. Rate variation through time: color density plot<a class="headerlink" href="#rate-variation-through-time-color-density-plot" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="whales-ratesthroughtime">
<a class="reference internal image-reference" href="_images/whales_RatesThroughTime.png"><img alt="_images/whales_RatesThroughTime.png" src="_images/whales_RatesThroughTime.png" style="width: 700px;" /></a>
</div>
<p>Evolutionary rates through time for whales, with color density shading to denote confidence on evolutionary rate reconstructions at any point in time:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">st</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">branching</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">whales</span><span class="p">))</span>
<span class="n">plotRateThroughTime</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">intervalCol</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">avgCol</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">time</span><span class="o">=</span><span class="n">st</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cex</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All whales&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plotRateThroughTime</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">intervalCol</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">avgCol</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">time</span><span class="o">=</span><span class="n">st</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">cex</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Dolphins only&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plotRateThroughTime</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">intervalCol</span><span class="o">=</span><span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">avgCol</span><span class="o">=</span><span class="s2">&quot;darkgreen&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">time</span><span class="o">=</span><span class="n">st</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">nodetype</span> <span class="o">=</span> <span class="s2">&quot;exclude&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cex</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Non-dolphins&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="evolutionary-rate-variation-through-time-grayscale">
<h2>3.7. Evolutionary rate variation through time: grayscale<a class="headerlink" href="#evolutionary-rate-variation-through-time-grayscale" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center" id="whales-ratesthroughtimebw">
<a class="reference internal image-reference" href="_images/whales_RatesThroughTimeBW.png"><img alt="_images/whales_RatesThroughTimeBW.png" src="_images/whales_RatesThroughTimeBW.png" style="width: 700px;" /></a>
</div>
<p>Grayscale plot of speciation rates through time during the radiation of modern whales. Shaded polygon denotes the 10% through 90% Bayesian credible regions on the distribution of rates at any point in time. The middle figure shows the rate-through-time estimates for the dolphins alone, and the right-hand figure shows the background rates for all whales once the dolphin clade has been excluded:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">plot</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
<span class="n">par</span><span class="p">(</span><span class="n">mfrow</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">st</span> <span class="o">&lt;-</span> <span class="nb">max</span><span class="p">(</span><span class="n">branching</span><span class="o">.</span><span class="n">times</span><span class="p">(</span><span class="n">whales</span><span class="p">))</span>
<span class="n">plotRateThroughTime</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">avgCol</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">time</span><span class="o">=</span><span class="n">st</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cex</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">intervalCol</span><span class="o">=</span><span class="s1">&#39;gray80&#39;</span><span class="p">,</span> <span class="n">intervals</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;All whales&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plotRateThroughTime</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">avgCol</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">time</span><span class="o">=</span><span class="n">st</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">cex</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">intervalCol</span><span class="o">=</span><span class="s1">&#39;gray80&#39;</span><span class="p">,</span> <span class="n">intervals</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Dolphins only&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="n">plotRateThroughTime</span><span class="p">(</span><span class="n">edata_whales</span><span class="p">,</span> <span class="n">avgCol</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">.</span><span class="n">time</span><span class="o">=</span><span class="n">st</span><span class="p">,</span> <span class="n">node</span><span class="o">=</span><span class="mi">140</span><span class="p">,</span> <span class="n">nodetype</span> <span class="o">=</span> <span class="s2">&quot;exclude&quot;</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">cex</span><span class="o">.</span><span class="n">axis</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span><span class="n">intervalCol</span><span class="o">=</span><span class="s1">&#39;gray80&#39;</span><span class="p">,</span> <span class="n">intervals</span><span class="o">=</span><span class="n">c</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">),</span> <span class="n">opacity</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Non-dolphins&quot;</span><span class="p">,</span> <span class="n">font</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">cex</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="rateshifts.html" title="4. Rate Shifts on Phylogenies: Theoretical Background"
             >next</a></li>
        <li class="right" >
          <a href="announcements.html" title="2. Announcements"
             >previous</a> |</li>
<li><a href="index.html">Home</a>&nbsp;|</li>
<li><a href="download.html">Download</a>&nbsp;|</li>
<li><a href="documentation.html">Documentation</a>&nbsp;|</li>
<li><a href="contact_us.html">Contact Us</a></li>
 
      </ul>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2015 BAMM Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.2.
    </div>
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-49579863-1', 'bamm-project.org');
ga('send', 'pageview');
</script>

  </body>
</html>