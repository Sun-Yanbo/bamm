<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9. Interpreting Rate Shifts on Phylogenies &mdash; bamm 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/bamm.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="bamm 1.0 documentation" href="index.html" />
    <link rel="prev" title="8. Frequently Asked Questions" href="faq.html" /> 
  </head>
  <body>
<div class="pageheader">
    <h1>BAMM: Bayesian Analysis of Macroevolutionary Mixtures</h1>
</div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="faq.html" title="8. Frequently Asked Questions"
             accesskey="P">previous</a> |</li>
<li><a href="index.html">Home</a>&nbsp;|</li>
<li><a href="download.html">Download</a>&nbsp;|</li>
<li><a href="documentation.html">Documentation</a></li>
 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="documentation.html">
              <img class="logo" src="_static/bamm-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="documentation.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9. Interpreting Rate Shifts on Phylogenies</a><ul>
<li><a class="reference internal" href="#the-bamm-model-is-an-approximation">9.1. The BAMM model is an approximation</a></li>
<li><a class="reference internal" href="#multiple-distinct-rate-shift-configurations-can-explain-your-data">9.2. Multiple distinct rate shift configurations can explain your data</a><ul>
<li><a class="reference internal" href="#is-this-really-a-problem">9.2.1. Is this really a problem?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rate-shifts-are-not-independent">9.3. Rate shifts are not independent</a></li>
<li><a class="reference internal" href="#meaningful-reporting-of-rate-shifts-in-the-bamm-framework">9.4. Meaningful reporting of &#8220;rate shifts&#8221; in the BAMM framework</a><ul>
<li><a class="reference internal" href="#shift-configurations-sampled-with-bamm">9.4.1. Shift configurations sampled with BAMM</a></li>
<li><a class="reference internal" href="#marginal-shift-probabilities">9.4.2. Marginal shift probabilities</a></li>
<li><a class="reference internal" href="#maximum-credibility-shift-configuration">9.4.3. Maximum credibility shift configuration</a></li>
<li><a class="reference internal" href="#cumulative-shift-probabilities">9.4.4. Cumulative shift probabilities</a></li>
<li><a class="reference internal" href="#some-complications-with-interpreting-shift-probabilities">9.4.5. Some complications with interpreting shift probabilities</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="faq.html"
                        title="previous chapter">8. Frequently Asked Questions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/rateshifts.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="interpreting-rate-shifts-on-phylogenies">
<span id="rateshifts"></span><h1>9. Interpreting Rate Shifts on Phylogenies<a class="headerlink" href="#interpreting-rate-shifts-on-phylogenies" title="Permalink to this headline">¶</a></h1>
<p>This section details some of the most common conceptual issues that can arise when interpreting rate shifts on phylogenetic trees. Many studies have attempted to identify <strong>*the*</strong> rate shifts within a given dataset. In the BAMM framework, there is no single set of independent rate shifts waiting to be identified. Rather, BAMM identifies <em>configurations</em> of rate shifts - sets of shifts that are sampled together - and enables us to compute relative probability of those configurations. Three <em>shift configurations</em> sampled with BAMM during simulation of the posterior are shown <a class="reference internal" href="bammgraph.html#dtmulti"><em>here</em></a>.</p>
<div class="section" id="the-bamm-model-is-an-approximation">
<h2>9.1. The BAMM model is an approximation<a class="headerlink" href="#the-bamm-model-is-an-approximation" title="Permalink to this headline">¶</a></h2>
<p>The models of diversification and trait evolution implemented in BAMM are approximations. This is true for any statistical model that you can use to extract information from data. Let&#8217;s consider a few assumptions of the models implemented in BAMM. The model assumes that a relatively small number of discrete shift events can explain the data (sort of.... it is more that the marginal likelihood of any particular model is implicitly penalized by the addition of more parameters).It is possible that many shifts in evolutionary dynamics change in a discrete fashion (e.g., the classic &#8220;key innovation&#8221; scenario), but it is also possible that major changes in dynamics occur through a number of sequential changes in some general region of a tree (see figure below).</p>
<div class="figure align-center" id="shifts1">
<a class="reference internal image-reference" href="_images/x_interpret1.png"><img alt="_images/x_interpret1.png" src="_images/x_interpret1.png" style="width: 700px;" /></a>
</div>
<p>This is the cetacean phylogeny (try <tt class="docutils literal"><span class="pre">data(whales)</span></tt> to load this tree) included as an example dataset with BAMMtools, and you can see some examples of rate variation across this tree <a class="reference internal" href="bammgraph.html#dtpolar"><em>here</em></a>. The tree on the left depicts the maximum shift credibility configuration identified by BAMM. This is simply the shift configuration sampled during simulation of the posterior with the highest marginal probability, analogous to the &#8220;maximum clade credibility tree&#8221; sampled during a Bayesian phylogenetic analysis (see below). The tree on the right gives an alternative interpretation of the results that would be invisible in the BAMM framework. Here, a relatively minor set of evolutionary shifts combine to produce - over several branches (red) - a major shift in evolutionary dynamics.</p>
<p>The point is that BAMM - and every other model that assumes discrete shifts in dynamics - can only detect discrete shifts in dynamics. Strictly speaking, this is less of a limitation for BAMM than other approaches. Because BAMM explicitly allows rates to vary through time after the point occurrence of a shift, the model does a reasonable job of tracking some types of continuous variation in evolutionary rates. In general, though, a spike in evolutionary rates inferred along a particular branch is fully consistent with the possibility that the &#8220;true&#8221; process involved a relatively continuous acceleration in rates that occurred over several branches. More generally, it is unlikely that such a continuous acceleration scenario over a relatively short period of time (e.g., tree on right) can even be detected from the sort of data we typically have available to us.</p>
<p>This is not a weakness <em>per se</em> of BAMM, and it applies to all other &#8220;macroevolutionary&#8221; scale modeling frameworks of which we are aware. However, recognizing the limitations of the discrete shift framework has a number of practical implications for interpreting patterns in data.</p>
</div>
<div class="section" id="multiple-distinct-rate-shift-configurations-can-explain-your-data">
<h2>9.2. Multiple distinct rate shift configurations can explain your data<a class="headerlink" href="#multiple-distinct-rate-shift-configurations-can-explain-your-data" title="Permalink to this headline">¶</a></h2>
<p>With most phylogenetic datasets, it is unlikely that you will be able to identify the specific branches on which rate shifts have occurred with extremely high confidence. More typically, you will be unable to exclude several different shift configurations that potentially account for a given pattern of phylogenetic branching or phenotypic diversity.</p>
<p>Currently, stepwise AIC and other model selection approaches are used to identify a single best set of rate shifts. We will single out some work that we have previously been involved with as an example of this type of approach. In Rabosky et al. (Proc. R. Soc. B, ###:###, 2007) and Alfaro et al. (PNAS ###:###, 2009), an information-theoretic model selection procedure is used to fit a set of models to phylogenetic data. Model complexity starts at 0, with the assumption that a single set of evolutionary rate parameters apply across an entire phylogeny. The algorithm then considers a more complex model, with two distinct evolutionary rate partitions across the tree. The actual likelihoods and AIC scores reported in these papers (and most subsequent papers that have cited them) tell us only about the relative fit of a model with <em>X</em> rate shifts relative to a model with <em>Y</em> rate shifts. There is typically no information in these analyses that provides the relative probability of different rate shift <a class="reference internal" href="bammgraph.html#dtmulti"><em>configurations</em></a>. All we get is the maximum likelihood <em>point estimate</em> of the best-fit shift configuration, but we get no information regarding our confidence in that estimate relative to other shift configurations with an identical number of rate shifts.</p>
<p>Here&#8217;s a graphical illustration of the logical problems associated with this. Suppose you analyze a particular phylogeny and find that a model with 2 distinct rate regimes fits the data better than a single rate regime with probability 1.0. You report the location of your rate shift identified using the stepwise procedure as follows:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/xFig2a.png"><img alt="_images/xFig2a.png" src="_images/xFig2a.png" style="width: 600px;" /></a>
</div>
<p>You go on to discuss this as strong evidence for a rate increase along the branch leading to clade A. You propose several potential key innovations that may have occurred along the branch leading to clade A that can potentially account for this discrepancy in species richness between clades A and B.</p>
<p>The problem here is that you have confounded statistical evidence for the <strong>number of rate shifts</strong> with statistical evidence for the <strong>location of the rate shifts</strong>. These are not the same. In fact, you have merely reported a single <em>point estimate</em> for a rate shift location that is consistent with your data. The true evidence for your rate shift locations might look more like this:</p>
<div class="figure align-center" id="toyshifts">
<a class="reference internal image-reference" href="_images/xFig2b.png"><img alt="_images/xFig2b.png" src="_images/xFig2b.png" style="width: 600px;" /></a>
</div>
<p>Here, you can see that - despite overall strong evidence for the occurrence of a rate shift <em>somewhere</em> in your tree - you can&#8217;t distinguish between several <strong>very different</strong> scenarios that have roughly equal probability. You can arrive at the observed disparity in diversity between clades A and B by (1) having a rate increase on the branch leading to clade A, or (2) a rate decrease on the branch leading to clade B. Unfortunately, there is nothing in your stepwise model-selection framework that provides this information. And these two scenarios lead to very different biological interpretations.</p>
<p>Simply speaking, reporting only the <em>maximum likelihood</em> shift location on a phylogenetic tree is exactly the same as publishing a single &#8220;best&#8221; estimate of a phylogeny with no measures of clade support. This would never be acceptable in the phylogenetic literature: at a minimum, we require bootstrap evidence, posterior probabilities, decay indices, or some other measure of the robustness of a particular inferred topology. However, in studying macroevolutionary dynamics, we frequently do <em>exactly what we would never do in phylogenetic biology</em>: we present point estimates with no probabilistic support measures, and we have mistaken support for a particular <strong>number of shifts</strong> for support bearing on their location.</p>
<p>Addressing this issue is one of the primary reasons that we created BAMM.</p>
<div class="section" id="is-this-really-a-problem">
<h3>9.2.1. Is this really a problem?<a class="headerlink" href="#is-this-really-a-problem" title="Permalink to this headline">¶</a></h3>
<p><strong>Yes</strong>.</p>
<p>We have encountered very few datasets where signal of a shift in rate dynamics along a particular branch is so strong that we can exclude alternative shift configurations with probability &gt; 0.95.</p>
<p>Consider the analysis of whale diversification, which we&#8217;ve included as an example dataset in BAMMtools. We also use this dataset as an empirical example in the primary description of the BAMM model (<strong>Link here to arxiv/plos</strong>). The figure below shows reconstructed speciation rates through time during the whale radiation (red = fast, blue = slow) under BAMM. Overall, the model with the highest posterior probability had two rate dynamics, and a model with just a single rate dynamic had a posterior probability approach zero. The marginal (branch-specific) probabilities of a rate shift occurring on the 3 most likely branches are as follows:</p>
<div class="figure align-center" id="whalemarg1">
<a class="reference internal image-reference" href="_images/xfig3a.png"><img alt="_images/xfig3a.png" src="_images/xfig3a.png" style="width: 650px;" /></a>
</div>
<p>Overall, we have very strong evidence for a shift in diversification dynamics somewhere near the origin of the dolphin clade, and the probability that at least one of the shifts illustrated above occurs is greater than 0.99. Although we are confident that a shift in dynamics <strong>has</strong> occurred, we cannot pin down a precise location of the shift. It would be incorrect to assert that the shift occurred on the branch with the highest marginal probability; it is almost as likely (p = 0.43) that the shift occurred on one of the ancestral branches immediately preceding the origin of the dolphin clade.</p>
</div>
</div>
<div class="section" id="rate-shifts-are-not-independent">
<h2>9.3. Rate shifts are not independent<a class="headerlink" href="#rate-shifts-are-not-independent" title="Permalink to this headline">¶</a></h2>
<p>Marginal shift probabilities - the probability that a shift occurred on a given branch, ignoring everything else in the tree - are useful, but they are <strong>not independent</strong> of shifts occurring elsewhere on the tree. The marginal shift probabilities in the figure <a class="reference internal" href="#whalemarg1"><em>above</em></a> cannot be treated as independent. In fact, the joint probability of a shift occurring on any two of the 3 principal branches (e.g., those with probs 0.05, 0.38, and 0.56) is approximately zero for all combinations. In other words, if you have a shift on one of these 3 branches for a given sample from the posterior, the conditional probability of a shift on any of the other branches leading to the dolphin clade is approximately zero.</p>
<p>Put simply: there is very strong (prob &gt; 0.99) evidence for a shift in dynamics somewhere along the ancestral 3 branches leading to the core dolphin clade. But there is only evidence for one such shift. Almost every sample from the posterior has a shift on at least one of these 3 branches, but no sample has a shift on more than one of these branches.</p>
<p>Because of the non-independence of rate shift configurations, it doesn&#8217;t really make sense to show - in a single tree - all the rate shifts discovered by BAMM. A good (but imperfect) analogy for thinking about rate shift configurations and their potential non-independence comes from Bayesian phylogenetic analysis. Any given shift configuration is like a phylogenetic tree sampled from a posterior. Some trees in that posterior will be incompatible with others. Trying to show all the rate shifts at once on a single tree, or reporting them as though they are independent, is sort of like trying to show a phylogenetic tree where you show all recovered clades at the same time. Suppose in a Bayesian phylogenetic analysis of 3 clades (A, B, C) you recover, each with probability 0.5, the following topologies: (A,(B,C)) and ((A,B),C). These topologies are incompatible, and it doesn&#8217;t make sense to demand a single phylogenetic tree that represents all sampled clades within a single tree. The solution in phylogenetics is to collapse these incompatible topologies to a consensus tree with a polytomy. Showing all rate shifts recovered with BAMM on a single phylogenetic tree is a bit like showing a consensus phylogeny with polytomies: it isn&#8217;t the &#8220;true&#8221; tree, but it summarizes some of the total run information.</p>
</div>
<div class="section" id="meaningful-reporting-of-rate-shifts-in-the-bamm-framework">
<h2>9.4. Meaningful reporting of &#8220;rate shifts&#8221; in the BAMM framework<a class="headerlink" href="#meaningful-reporting-of-rate-shifts-in-the-bamm-framework" title="Permalink to this headline">¶</a></h2>
<p>There are many types of information that can be extracted from a BAMM run. Here we describe several useful methods of summarizing and visualizing shift information from a BAMM analysis.</p>
<div class="section" id="shift-configurations-sampled-with-bamm">
<h3>9.4.1. Shift configurations sampled with BAMM<a class="headerlink" href="#shift-configurations-sampled-with-bamm" title="Permalink to this headline">¶</a></h3>
<p>One of the most important ideas to grasp regarding BAMM is that BAMM simulates a posterior distribution of <em>shift configurations</em> on phylogenetic trees. Hence, every sample from a posterior simulated with BAMM may contain a potentially unique configuration of rate shifts. Here are 3 different shift configurations for the primates dataset included in BAMMtools. The fourth tree is a phylorate plot, showing instantaneous (marginal) phenotypic evolutionary rates at fine-grained set of points along the phylogeny. Note that the shift configurations are different for each sample from the posterior.</p>
<div class="figure align-center" id="primateconfigs">
<a class="reference internal image-reference" href="_images/xprimates_shiftconfigs.png"><img alt="_images/xprimates_shiftconfigs.png" src="_images/xprimates_shiftconfigs.png" style="width: 650px;" /></a>
</div>
</div>
<div class="section" id="marginal-shift-probabilities">
<h3>9.4.2. Marginal shift probabilities<a class="headerlink" href="#marginal-shift-probabilities" title="Permalink to this headline">¶</a></h3>
<p>The marginal shift probabilities on individual branches across the tree are of considerable interest. As discussed above, there are some nuances to interpreting these, because the probability associated with any particular branch is not independent of other branches in the tree. From your bammdata object, you can easily compute the branch-specific marginal shift probabilities with BAMMtools:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">library</span><span class="p">(</span><span class="n">BAMMtools</span><span class="p">)</span>
<span class="n">data</span><span class="p">(</span><span class="n">whales</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">whales</span><span class="p">)</span>
<span class="n">ed</span> <span class="o">&lt;-</span> <span class="n">getEventData</span><span class="p">(</span><span class="n">whales</span><span class="p">,</span> <span class="n">events</span><span class="o">.</span><span class="n">whales</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">marg_probs</span> <span class="o">&lt;-</span> <span class="n">marginalShiftProbsTree</span><span class="p">(</span><span class="n">ed</span><span class="p">)</span>
</pre></div>
</div>
<p>The object <tt class="docutils literal"><span class="pre">marg_probs</span></tt> is a copy of your original phylogenetic tree, but where the branch lengths have been replaced by the branch-specific marginal shift probabilities. In other words, the length of a given branch is equal to the percentage of samples from the posterior that contain a rate shift on that particular branch.</p>
<p>You can convey this information in several possible ways. You can directly indicate marginal shift probabilities on a phylorate plot, as shown <a class="reference internal" href="#whalemarg1"><em>here</em></a>. You can plot your <tt class="docutils literal"><span class="pre">marg_probs</span></tt> tree itself: the branches are scaled directly by probabilities, so a tree plotted in such a fashion conveys quite a bit of information (see Figure 9 from Rabosky 2014 for an example of such a plot). You can potentially color branches by their marginal shift probabilities, or you could add circles to each branch with a shift probability greater than some threshold.</p>
<p>But don&#8217;t get hung up on the fact that your shift probabilities are less than 0.95. Even <em>very</em> strongly supported rate heterogeneity will generally be associated with marginal shift probabilities &lt; 0.95. As discussed <a class="reference internal" href="#whalemarg1"><em>here</em></a>, you can (and often will) have exceptionally strong evidence for rate heterogeneity even if any given branch has marginal shift probabilities that do not appear particularly high. <strong>Marginal shift probabilities tell you very little about the probability of rate heterogeneity in your dataset</strong>. In principle, you could have high confidence that your data were shaped by a very large number of rate shifts, but at the same time find that no single branch has a marginal probability exceeding 0.10.</p>
</div>
<div class="section" id="maximum-credibility-shift-configuration">
<h3>9.4.3. Maximum credibility shift configuration<a class="headerlink" href="#maximum-credibility-shift-configuration" title="Permalink to this headline">¶</a></h3>
<p>Marginal shift probabilities don&#8217;t tell you much about the most likely sets of shifts that generated your dataset. One possible estimate of the <em>most likely shift configuration</em> is the <strong>maximum credibility shift (MCS) configuration</strong>. This concept is analogous to the <em>maximum clade credibility</em> tree in a Bayesian phylogenetic analysis. The MCS configuration is a rate shift configuration that was actually sampled by BAMM and which is one estimate of the best overall configuration. Formally, the MCS configuration is estimated in several steps. First, we compute the marginal shift probabilities on each branch of the tree. For the i<sup>th</sup> branch, denote this probability as p<sub>i</sub>. For each sample shift configuration from the posterior, we then compute the product of the observed set of shifts, using these marginal probabilities. These are then weighted by the posterior probability of sample <em>k</em> (as defined by the number of processes), or <em>P(k)</em>. The shift credibility score <em>C</em> for the k<sup>th</sup> sample is computed as:</p>
<div class="math">
<p><img src="_images/math/f4e902db9ae6ea1f141f08054ae3909942e45a87.png" alt="C = P(k) \prod_{i = 1}^{N}{p_i^{I_{i,k}}}{(1 - p_i)^{1 - I_{i,k}}}"/></p>
</div><p>where I<sub>i,k</sub> is an indicator variable taking a value of 1 if a shift occurs on branch <em>i</em> for sample <em>k</em>, and 0 if no shift occurs in the sample. In BAMMtools, you can easily estimate the MSC configuration:</p>
<div class="highlight-python"><pre>&gt; library(BAMMtools)
&gt; data(primates, events.primates)
&gt; ed &lt;- getEventData(primates, events.primates, burnin=0.1)
&gt; msc_tree &lt;- maximumShiftCredibility(ed)</pre>
</div>
<p>Here we&#8217;ll simply plot the MSC shift configuration on a boring (non-phylorate) version of the primate tree:</p>
<div class="figure align-center" id="primatemsc">
<a class="reference internal image-reference" href="_images/xprimates_msc.png"><img alt="_images/xprimates_msc.png" src="_images/xprimates_msc.png" style="width: 600px;" /></a>
</div>
<p>The MSC tree has a total of two shifts (red circles). Interestingly, this is <em>not</em> the tree we might have expected to be the MSC tree. For the primates data, a model with 4 shifts has the highest posterior probability, something we could have checked with:</p>
<div class="highlight-python"><pre>&gt; # Assuming ed is still the primate bammdata object:
&gt; summary(ed)</pre>
</div>
<p>It is possible that multiple shift configurations will have an identical credibility score  (the function <cite>maximumShiftCredibility</cite> will identify these).</p>
<p>For publication, rather than (or in addition to) showing all shifts (or marginal shift probabilities), consider plotting the locations of shifts for the MSC tree, either on the phylorate plot or another plotted tree object.</p>
</div>
<div class="section" id="cumulative-shift-probabilities">
<h3>9.4.4. Cumulative shift probabilities<a class="headerlink" href="#cumulative-shift-probabilities" title="Permalink to this headline">¶</a></h3>
<p>The <em>cumulative shift shift probability tree</em> shows the probability that a given node has evolutionary rate dynamics that are decoupled from the root process. For a given node to be decoupled from the &#8220;background&#8221; evolutionary dynamic, a rate shift must occur somewhere on the path between the node and the root of the tree. Branches with a cumulative shift probability of 1.0 imply that every sample in the posterior shows at least one rate shift between the focal branch and the root of the tree, leading to evolutionary dynamics that are decoupled from the background process.</p>
<p>Consider the whale diversification <a class="reference internal" href="#whalemarg1"><em>analysis</em></a>. Even though we have relatively low confidence of the precise branch on which a shift may have occurred, we have high confidence that a shift occurred on one of the ancestral branches leading to the dolphin clade. Formally, the cumulative shift probability for branch b<sub>i</sub> is computed as:</p>
<div class="math">
<p><img src="_images/math/af836e6b378c336c2b7148fb2c991f8bad248bdd.png" alt="b_i = \frac{\sum_{k = 1}^{S}\Phi_{k,i}}{N}"/></p>
</div><p>where <img class="math" src="_images/math/6bbd760f4f3a19f27bc58824558ef30ca389993f.png" alt="\Phi_{k,i}"/> is an indicator variable that takes a value of 1 if a shift occurs somewhere on the path between branch <em>i</em> and the root of the tree (0 otherwise). The cumulative shift probability on a particular branch <img class="math" src="_images/math/94d9565abaadf04609a2e9941aa2d20b0a299b8a.png" alt="b_i"/> might thus be extremely high even if shifts are unlikely to have occurred on branch <img class="math" src="_images/math/94d9565abaadf04609a2e9941aa2d20b0a299b8a.png" alt="b_i"/> itself. Here we will compute the marginal shift probability tree using the <em>cumulativeShiftProbsTree</em> function from BAMMtools.</p>
<p>Here is another view of the whales analysis where we will use color to show all branches that are &#8220;strongly&#8221; associated (p &gt; 0.95) with diversification dynamics that are decoupled from those at the root of the tree.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/x_whales_cst.png"><img alt="_images/x_whales_cst.png" src="_images/x_whales_cst.png" style="width: 600px;" /></a>
</div>
</div>
<div class="section" id="some-complications-with-interpreting-shift-probabilities">
<h3>9.4.5. Some complications with interpreting shift probabilities<a class="headerlink" href="#some-complications-with-interpreting-shift-probabilities" title="Permalink to this headline">¶</a></h3>
<p>It is incorrect to assume that you need &#8220;significant&#8221; (p &gt; 0.95) marginal shift probabilities or cumulative shift probabilities to demonstrate significant rate heterogeneity in your dataset. The evidence for rate heterogeneity comes from considering the posterior probabilities on the number of shifts, or - even better - the Bayes factor evidence in favor of model with <em>k</em> shifts (<img class="math" src="_images/math/2d2e634a37481384d574ce449c610d1af04f04bc.png" alt="M_k"/>) relative to a model with 0 shifts (<img class="math" src="_images/math/ae8894f3de7431ea6446c8b17ba3407f9f752ab2.png" alt="M_0"/>).</p>
<p>In the toy example <a class="reference internal" href="#toyshifts"><em>above</em></a>, we had evidence for rate heterogeneity in the dataset (with posterior probability 1.0), yet neither the marginal shift probabilities (0.49, 0.51) nor the cumulative shift probabilities (same as marginals for this example) would be &#8220;significant&#8221;.  This is a most important point: you can have massive evidence for rate heterogeneity in your dataset, but both your marginal and cumulative shift probabilities will be a function of the frequency distribution of <strong>distinct alternative shift configurations</strong>.</p>
<p>The primate body mass example dataset is a good example of this. Here, we have strong evidence against a single evolutionary rate regime. In fact, the Bayes factor evidence favoring a model with 5 rate regimes (<img class="math" src="_images/math/223f1095e7d6d4bdb649323e0c6921d007f2b2db.png" alt="M_5"/>) versus a model with 0 rate regimes (<img class="math" src="_images/math/ae8894f3de7431ea6446c8b17ba3407f9f752ab2.png" alt="M_0"/>) exceeds 60,000. For <img class="math" src="_images/math/223f1095e7d6d4bdb649323e0c6921d007f2b2db.png" alt="M_5"/> versus <img class="math" src="_images/math/3c6a4a0680d4e0668219585d856c7f109cd09f77.png" alt="M_1"/>, this ratio exceeds 8,000. Numbers like these imply that it isn&#8217;t even worth considering simple models of body size evolution (e.g., one or two-rate Brownian motion models).</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="faq.html" title="8. Frequently Asked Questions"
             >previous</a> |</li>
<li><a href="index.html">Home</a>&nbsp;|</li>
<li><a href="download.html">Download</a>&nbsp;|</li>
<li><a href="documentation.html">Documentation</a></li>
 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013 BAMM Team.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b3.
    </div>
  </body>
</html>